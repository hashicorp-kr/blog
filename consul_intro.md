# Consul은 무엇입니까?

Consul은 서비스 발견, 구성 및 세분화 기능을 갖춘 완전한 기능의 제어 플레인을 제공하는 서비스 메시 솔루션입니다. 이러한 각 기능은 필요에 따라 개별적으로 사용하거나 전체 서비스 메시를 구축하기 위해 함께 사용할 수 있습니다. Consul에는 데이터 평면이 필요하며 프록시 및 기본 통합 모델을 모두 지원합니다. Consul은 간단한 기본 제공 프록시를 제공하므로 모든 것이 기본적으로 작동하지만 Envoy와 같은 타사 프록시 통합도 지원합니다.

Consul의 주요 기능은 다음과 같습니다.

- 서비스 검색 (Service Discovery) : Consul 클라이언트는 api 또는 mysql과 같은 서비스를 등록 할 수 있으며 다른 클라이언트는 Consul을 사용하여 지정된 서비스 공급자를 검색 할 수 있습니다. 응용 프로그램은 DNS 또는 HTTP를 사용하여 의존하는 서비스를 쉽게 찾을 수 있습니다.
- 상태 확인 (Health Checking) : Consul 클라이언트는 지정된 서비스 ( "웹 서버는 200을 반환합니다") 또는 로컬 노드 ( "메모리 사용률은 90 % 미만")와 관련된 여러 가지 상태 확인을 제공 할 수 있습니다. 이 정보는 운영자가 클러스터 상태를 모니터링하는 데 사용할 수 있으며 서비스 감지 구성 요소가 트래픽을 비정상 호스트로부터 멀리 라우팅하는 데 사용됩니다.
- KV 스토어 (KV Store) : 애플리케이션은 동적 구성, 기능 표시, 조정, 리더 선출 등 다양한 목적으로 Consul의 계층적 키/값 저장소를 사용할 수 있습니다. 간단한 HTTP API를 사용하면 쉽게 사용할 수 있습니다.
- 안전한 서비스 통신 (Secure Service Communication): Consul은 상호 TLS 연결을 설정하기 위해 서비스에 대한 TLS 인증서를 생성 및 배포 할 수 있습니다. 의사 소통을 통해 의사 소통이 허용되는 서비스를 정의 할 수 있습니다. 복잡한 네트워크 토폴로지 및 정적 방화벽 규칙을 사용하는 대신 실시간으로 변경할 수있는 의도로 서비스 세분화를 쉽게 관리 할 수 있습니다.
- 다중 데이터 센터 (Multi DataCenter) : Consul은 기본적으로 여러 데이터 센터를 지원합니다. 이는 Consul 사용자가 여러 지역으로 확장하기 위해 추가 추상화 계층을 구축 할 필요가 없음을 의미합니다.

Consul은 DevOps 커뮤니티 및 애플리케이션 개발자 모두에게 친숙하도록 설계되어 현대적이고 탄력적 인 인프라에 적합합니다.

# Consul의 기본 아키텍처
Consul은 분산된 고 가용성 시스템입니다. 
Consul에 서비스를 제공하는 모든 노드는 Consul 에이전트를 실행합니다. 다른 서비스를 발견하거나 키/값 데이터를 가져 오거나 설정하기 위해 에이전트를 실행할 필요는 없습니다. 에이전트는 노드 자체뿐만 아니라 노드의 서비스 상태를 점검합니다.

Agent는 하나 이상의 Consul 서버와 통신합니다. Consul 서버는 데이터가 저장되고 복제되는 위치입니다. 서버 자체가 리더를 선출합니다. Consul은 하나의 서버에서 작동 할 수 있지만 데이터 손실로 이어지는 장애 시나리오를 피하기 위해 3-5가 권장됩니다. 각 데이터 센터마다 Consul 서버 클러스터가 권장됩니다.

다른 서비스 또는 노드를 검색해야하는 인프라 구성 요소는 모든 Consul 서버 또는 Consul 에이전트를 쿼리 할 수 있습니다. 에이전트는 쿼리를 서버에 자동으로 전달합니다.

각 데이터 센터는 Consul 서버 클러스터를 실행합니다. 데이터 센터 간 서비스 검색 또는 구성 요청이 수행되면 로컬 Consul 서버는 요청을 원격 데이터 센터로 전달하고 결과를 반환합니다.

상세한 아키텍처는 다음 포스팅에서 다룰 예정입니다.

